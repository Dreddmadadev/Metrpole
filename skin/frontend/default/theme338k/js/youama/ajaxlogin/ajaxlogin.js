!function(p){p.fn.youamaAjaxLogin=function(o){var a,e,r,n=p.extend({},p.fn.youamaAjaxLogin.defaults,o);return a=p(".youama-login-window"),e=p(".youama-register-window"),r=p(".youama-ajaxlogin-loader"),p("#header-account").html(a),p("#header-account").append(e),p("#header-account").append(r),p('a[href*="customer/account/create"], a[href*="customer/account/login"], .customer-account-login .new-users button').attr("onclick","return false;"),"yes"==n.autoShowUp&&"block"!=p(".messages").css("display")&&(p(".skip-links .skip-account").trigger("click"),s("login")),p(".skip-links .skip-account").on("click",function(){return"none"!=p(".youama-login-window").css("display")||"none"!=p(".youama-register-window").css("display")?l("login",!1,!1):s("login"),!1}),p('a[href*="customer/account/login"]').click(function(){p(".skip-links .skip-account").trigger("click"),p("div.shadow").addClass("active-form")}),p(".yoauam-switch-window").on("click",function(){"y-to-login"==p(this).attr("id")?(i(),l("register",!1,!1),s("login")):(i(),l("login",!1,!1),s("register"))}),p('a[href*="customer/account/create"], .new-users button').on("click",function(){return p(".skip-links .skip-account").trigger("click"),l("login",!1,!1),s("register"),!1}),p(".youama-login-window .close").click(function(){l("login",!0,!0),p("div.shadow").removeClass("active-form"),p("body").removeClass("ind")}),p(".youama-register-window .close").click(function(){l("register",!0,!0),p("div.shadow").removeClass("active-form"),p("body").removeClass("ind")}),void(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEmobile|Windows Phone|WPDesktop/i.test(navigator.userAgent)||(g(),p(window).resize(function(){g(),p("div.shadow").removeClass("active-form"),p("body").removeClass("ind")}),p(".skip-links a").click(function(){g(),p("div.shadow").removeClass("active-form"),p("body").removeClass("ind")}))),p(".youama-register-window button").on("click",function(){return u("register"),c("register"),""!=n.errors?w(n.errors,"register"):function(){if(1!=n.stop){n.stop=!0,t("register","start");var o=jQuery.ajax({url:n.controllerUrl,type:"POST",data:{ajax:"register",firstname:n.firstname,lastname:n.lastname,newsletter:n.newsletter,email:n.email,password:n.password,passwordsecond:n.passwordsecond,licence:n.licence},dataType:"html"});o.done(function(o){"success"!=o?w(o,"register"):(l("register",n.stop=!1,!0),"1"==n.redirection?window.location=n.profileUrl:window.location.reload()),t("register","stop"),n.stop=!1}),o.fail(function(o,a,e){n.stop=!1,t("register","stop")})}}(),!1}),p(document).keypress(function(o){13==o.which&&"block"==p(".youama-login-window").css("display")&&(u("login"),c("login"),""!=n.errors?w(n.errors,"login"):m())}),void p(".youama-login-window button").on("click",function(){return u("login"),c("login"),""!=n.errors?w(n.errors,"login"):m(),!1});function i(){p("html,body").animate({scrollTop:0})}function s(o){p(".youama-"+o+"-window").slideDown(300,"easeInOutCirc")}function t(o,a){"start"==a?(p(".youama-ajaxlogin-loader").fadeIn(),p(".youama-"+o+"-window").animate({opacity:"0.4"})):p(".youama-ajaxlogin-loader").fadeOut("normal",function(){p(".youama-"+o+"-window").animate({opacity:"1"})})}function l(o,a,e){1!=n.stop&&(1==a?(p(".youama-"+o+"-window").hide(),p(".youama-ajaxlogin-error").hide(function(){e&&p("#header-account").removeClass("skip-active")})):(p(".youama-ajaxlogin-error").fadeOut(),p(".youama-"+o+"-window").slideUp(function(){e&&p("#header-account").removeClass("skip-active")})))}function c(o){n.errors="","register"==o?(n.lastname.length<1&&(n.errors=n.errors+"nolastname,"),n.firstname.length<1&&(n.errors=n.errors+"nofirstname,"),n.email.length<1?n.errors=n.errors+"noemail,":1!=d(n.email)&&(n.errors=n.errors+"wrongemail,"),n.password.length<1?n.errors=n.errors+"nopassword,":n.password.length<6?n.errors=n.errors+"shortpassword,":16<n.password.length?n.errors=n.errors+"longpassword,":n.password!=n.passwordsecond&&(n.errors=n.errors+"notsamepasswords,"),"ok"!=n.licence&&(n.errors=n.errors+"nolicence,")):"login"==o&&(n.email.length<1?n.errors=n.errors+"noemail,":1!=d(n.email)&&(n.errors=n.errors+"wrongemail,"),n.password.length<1?n.errors=n.errors+"nopassword,":16<n.password.length&&(n.errors=n.errors+"wronglogin,"))}function d(o){return!!/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/.test(o)}function u(o){"register"==o?(n.firstname=p(".youama-"+o+"-window #youama-firstname").val(),n.lastname=p(".youama-"+o+"-window #youama-lastname").val(),0<p(".youama-"+o+'-window input[name="youama-newsletter"]:checked').length?n.newsletter="ok":n.newsletter="no",n.email=p(".youama-"+o+"-window #youama-email").val(),n.password=p(".youama-"+o+"-window #youama-password").val(),n.passwordsecond=p(".youama-"+o+"-window #youama-passwordsecond").val(),0<p(".youama-"+o+'-window input[name="youama-licence"]:checked').length?n.licence="ok":n.licence="no"):"login"==o&&(n.email=p(".youama-"+o+"-window #youama-email").val(),n.password=p(".youama-"+o+"-window #youama-password").val())}function w(o,a){p(".youama-"+a+"-window .youama-ajaxlogin-error").text(""),p(".youama-"+a+"-window .youama-ajaxlogin-error").hide();for(var e=new Array,r=(e=o.split(",")).length-1,n=0;n<r;n++){var i=p(".ytmpa-"+e[n]).text();p(".youama-"+a+"-window .err-"+e[n]).text(i)}p(".youama-"+a+"-window .youama-ajaxlogin-error").fadeIn()}function m(){if(1!=n.stop){n.stop=!0,t("login","start");var o=jQuery.ajax({url:n.controllerUrl,type:"POST",data:{ajax:"login",email:n.email,password:n.password},dataType:"html"});o.done(function(o){"success"!=o?w(o,"login"):(l("login",n.stop=!1,!0),"1"==n.redirection?window.location=n.profileUrl:window.location.reload()),t("login","stop"),n.stop=!1}),o.fail(function(o,a,e){n.stop=!1,t("login","stop")})}}function g(){1!=p("#header-account").hasClass("skip-active")&&(l("login",!0,!1),l("register",!0,!1))}},p.fn.youamaAjaxLogin.defaults={redirection:"0",windowSize:"",stop:!1,controllerUrl:"",profileUrl:"",autoShowUp:"",errors:"",firstname:"",lastname:"",newsletter:"no",email:"",password:"",passwordsecond:"",licence:"no"}}(jQuery);