!function(h){Function.prototype.bind||(Function.prototype.bind=function(t){var e=[].slice,i=e.call(arguments,1),s=this,o=function(){},n=function(){return s.apply(this instanceof o?this:t||{},i.concat(e.call(arguments)))};return o.prototype=s.prototype,n.prototype=new o,n}),void 0===h.Code&&(h.Code={}),h.Code.Util={registerNamespace:function(){var t,e,i,s,o,n,a=arguments,r=null;for(t=0,o=a.length;t<o;t++)for(s=(i=a[t].split("."))[0],void 0===h[s]&&(h[s]={}),r=h[s],e=1,n=i.length;e<n;++e)r[i[e]]=r[i[e]]||{},r=r[i[e]]},coalesce:function(){var t,e;for(t=0,e=arguments.length;t<e;t++)if(!this.isNothing(arguments[t]))return arguments[t];return null},extend:function(t,e,i){var s;if(this.isNothing(i)&&(i=!0),t&&e&&this.isObject(e))for(s in e)this.objectHasProperty(e,s)&&(i?t[s]=e[s]:void 0===t[s]&&(t[s]=e[s]))},clone:function(t){var e={};return this.extend(e,t),e},isObject:function(t){return t instanceof Object},isFunction:function(t){return"[object Function]"==={}.toString.call(t)},isArray:function(t){return t instanceof Array},isLikeArray:function(t){return"number"==typeof t.length},isNumber:function(t){return"number"==typeof t},isString:function(t){return"string"==typeof t},isNothing:function(t){return null==t},swapArrayElements:function(t,e,i){var s=t[e];t[e]=t[i],t[i]=s},trim:function(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},toCamelCase:function(t){return t.replace(/(\-[a-z])/g,function(t){return t.toUpperCase().replace("-","")})},toDashedCase:function(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})},arrayIndexOf:function(t,e,i){var s,o,n,a;for(n=-1,s=0,o=e.length;s<o;s++)if(a=e[s],this.isNothing(i)){if(a===t){n=s;break}}else if(this.objectHasProperty(a,i)&&a[i]===t){n=s;break}return n},objectHasProperty:function(t,e){return t.hasOwnProperty?t.hasOwnProperty(e):void 0!==t[e]}}}(window),function(e,s){s.Browser={ua:null,version:null,safari:null,webkit:null,opera:null,msie:null,chrome:null,mozilla:null,android:null,blackberry:null,iPad:null,iPhone:null,iPod:null,iOS:null,is3dSupported:null,isCSSTransformSupported:null,isTouchSupported:null,isGestureSupported:null,_detect:function(){this.ua=e.navigator.userAgent,this.version=this.ua.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[],this.safari=/Safari/gi.test(e.navigator.appVersion),this.webkit=/webkit/i.test(this.ua),this.opera=/opera/i.test(this.ua),this.msie=/msie/i.test(this.ua)&&!this.opera,this.chrome=/Chrome/i.test(this.ua),this.firefox=/Firefox/i.test(this.ua),this.fennec=/Fennec/i.test(this.ua),this.mozilla=/mozilla/i.test(this.ua)&&!/(compatible|webkit)/.test(this.ua),this.android=/android/i.test(this.ua),this.blackberry=/blackberry/i.test(this.ua),this.iOS=/iphone|ipod|ipad/gi.test(e.navigator.platform),this.iPad=/ipad/gi.test(e.navigator.platform),this.iPhone=/iphone/gi.test(e.navigator.platform),this.iPod=/ipod/gi.test(e.navigator.platform);var t=document.createElement("div");this.is3dSupported=!s.isNothing(t.style.WebkitPerspective),this.isCSSTransformSupported=!s.isNothing(t.style.WebkitTransform)||!s.isNothing(t.style.MozTransform)||!s.isNothing(t.style.transformProperty),this.isTouchSupported=this.isEventSupported("touchstart"),this.isGestureSupported=this.isEventSupported("gesturestart")},_eventTagNames:{select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"},isEventSupported:function(t){var e,i=document.createElement(this._eventTagNames[t]||"div");return t="on"+t,(e=s.objectHasProperty(i,t))||(i.setAttribute(t,"return;"),e="function"==typeof i[t]),i=null,e},isLandscape:function(){return s.DOM.windowWidth()>s.DOM.windowHeight()}},s.Browser._detect()}(window,window.Code.Util),function(t,o,i){i.extend(i,{Events:{add:function(t,e,i){o(t).bind(e,i)},remove:function(t,e,i){o(t).unbind(e,i)},fire:function(t,e){var i,s=Array.prototype.slice.call(arguments).splice(2);i="string"==typeof e?{type:e}:e,o(t).trigger(o.Event(i.type,i),s)},getMousePosition:function(t){return{x:t.pageX,y:t.pageY}},getTouchEvent:function(t){return t.originalEvent},getWheelDelta:function(t){var e=0;return i.isNothing(t.wheelDelta)?i.isNothing(t.detail)||(e=-t.detail/3):e=t.wheelDelta/120,e},domReady:function(t){o(document).ready(t)}}})}(window,window.jQuery,window.Code.Util),function(a,r,h){h.extend(h,{DOM:{setData:function(t,e,i){var s,o;if(h.isLikeArray(t))for(s=0,o=t.length;s<o;s++)h.DOM._setData(t[s],e,i);else h.DOM._setData(t,e,i)},_setData:function(t,e,i){h.DOM.setAttribute(t,"data-"+e,i)},getData:function(t,e,i){return h.DOM.getAttribute(t,"data-"+e,i)},removeData:function(t,e){var i,s;if(h.isLikeArray(t))for(i=0,s=t.length;i<s;i++)h.DOM._removeData(t[i],e);else h.DOM._removeData(t,e)},_removeData:function(t,e){h.DOM.removeAttribute(t,"data-"+e)},isChildOf:function(t,e){if(e===t)return!1;for(;t&&t!==e;)t=t.parentNode;return t===e},find:function(t,e){h.isNothing(e)&&(e=a.document);var i,s,o=r(t,e),n=[];for(i=0,s=o.length;i<s;i++)n.push(o[i]);return n},createElement:function(t,e,i){var s=r("<"+t+"></"+t+">");return s.attr(e),s.append(i),s[0]},appendChild:function(t,e){r(e).append(t)},insertBefore:function(t,e,i){r(t).insertBefore(e)},appendText:function(t,e){r(e).text(t)},appendToBody:function(t){r("body").append(t)},removeChild:function(t,e){r(t).empty().remove()},removeChildren:function(t){r(t).empty()},hasAttribute:function(t,e){return!h.isNothing(r(t).attr(e))},getAttribute:function(t,e,i){var s=r(t).attr(e);return h.isNothing(s)&&!h.isNothing(i)&&(s=i),s},setAttribute:function(t,e,i){var s,o;if(h.isLikeArray(t))for(s=0,o=t.length;s<o;s++)h.DOM._setAttribute(t[s],e,i);else h.DOM._setAttribute(t,e,i)},_setAttribute:function(t,e,i){r(t).attr(e,i)},removeAttribute:function(t,e){var i,s;if(h.isLikeArray(t))for(i=0,s=t.length;i<s;i++)h.DOM._removeAttribute(t[i],e);else h.DOM._removeAttribute(t,e)},_removeAttribute:function(t,e){r(t).removeAttr(e)},addClass:function(t,e){var i,s;if(h.isLikeArray(t))for(i=0,s=t.length;i<s;i++)h.DOM._addClass(t[i],e);else h.DOM._addClass(t,e)},_addClass:function(t,e){r(t).addClass(e)},removeClass:function(t,e){var i,s;if(h.isLikeArray(t))for(i=0,s=t.length;i<s;i++)h.DOM._removeClass(t[i],e);else h.DOM._removeClass(t,e)},_removeClass:function(t,e){r(t).removeClass(e)},hasClass:function(t,e){r(t).hasClass(e)},setStyle:function(t,e,i){var s,o;if(h.isLikeArray(t))for(s=0,o=t.length;s<o;s++)h.DOM._setStyle(t[s],e,i);else h.DOM._setStyle(t,e,i)},_setStyle:function(t,e,i){var s;if(h.isObject(e))for(s in e)h.objectHasProperty(e,s)&&("width"===s?h.DOM.width(t,e[s]):"height"===s?h.DOM.height(t,e[s]):r(t).css(s,e[s]));else r(t).css(e,i)},getStyle:function(t,e){return r(t).css(e)},hide:function(t){var e,i;if(h.isLikeArray(t))for(e=0,i=t.length;e<i;e++)h.DOM._hide(t[e]);else h.DOM._hide(t)},_hide:function(t){r(t).hide()},show:function(t){var e,i;if(h.isLikeArray(t))for(e=0,i=t.length;e<i;e++)h.DOM._show(t[e]);else h.DOM._show(t)},_show:function(t){r(t).show()},width:function(t,e){return h.isNothing(e)||r(t).width(e),r(t).width()},outerWidth:function(t){return r(t).outerWidth()},height:function(t,e){return h.isNothing(e)||r(t).height(e),r(t).height()},outerHeight:function(t){return r(t).outerHeight()},documentWidth:function(){return r(document.documentElement).width()},documentHeight:function(){return r(document.documentElement).height()},documentOuterWidth:function(){return h.DOM.width(document.documentElement)},documentOuterHeight:function(){return h.DOM.outerHeight(document.documentElement)},bodyWidth:function(){return r(document.body).width()},bodyHeight:function(){return r(document.body).height()},bodyOuterWidth:function(){return h.DOM.outerWidth(document.body)},bodyOuterHeight:function(){return h.DOM.outerHeight(document.body)},windowWidth:function(){return a.innerWidth?a.innerWidth:r(a).width()},windowHeight:function(){return a.innerHeight?a.innerHeight:r(a).height()},windowScrollLeft:function(){return a.pageXOffset?a.pageXOffset:r(a).scrollLeft()},windowScrollTop:function(){return a.pageYOffset?a.pageYOffset:r(a).scrollTop()}}})}(window,window.jQuery,window.Code.Util),function(u,g){g.extend(g,{Animation:{_applyTransitionDelay:50,_transitionEndLabel:void 0!==u.document.documentElement.style.webkitTransition?"webkitTransitionEnd":"transitionend",_transitionEndHandler:null,_transitionPrefix:void 0!==u.document.documentElement.style.webkitTransition?"webkitTransition":void 0!==u.document.documentElement.style.MozTransition?"MozTransition":"transition",_transformLabel:void 0!==u.document.documentElement.style.webkitTransform?"webkitTransform":void 0!==u.document.documentElement.style.MozTransition?"MozTransform":"transform",_getTransitionEndHandler:function(){return g.isNothing(this._transitionEndHandler)&&(this._transitionEndHandler=this._onTransitionEnd.bind(this)),this._transitionEndHandler},stop:function(t){if(g.Browser.isCSSTransformSupported){t.style[this._transitionPrefix+"Property"];var e={};g.Events.remove(t,this._transitionEndLabel,this._getTransitionEndHandler()),g.isNothing(t.callbackLabel)&&delete t.callbackLabel,e[this._transitionPrefix+"Property"]="",e[this._transitionPrefix+"Duration"]="",e[this._transitionPrefix+"TimingFunction"]="",e[this._transitionPrefix+"Delay"]="",e[this._transformLabel]="",g.DOM.setStyle(t,e)}else g.isNothing(u.jQuery)||u.jQuery(t).stop(!0,!0)},fadeIn:function(t,e,i,s,o){((o=g.coalesce(o,1))<=0&&(o=1),e<=0&&(g.DOM.setStyle(t,"opacity",o),!g.isNothing(i)))?i(t):(1<=g.DOM.getStyle(t,"opacity")&&g.DOM.setStyle(t,"opacity",0),g.Browser.isCSSTransformSupported?this._applyTransition(t,"opacity",o,e,i,s):g.isNothing(u.jQuery)||u.jQuery(t).fadeTo(e,o,i))},fadeTo:function(t,e,i,s,o){this.fadeIn(t,i,s,o,e)},fadeOut:function(t,e,i,s){e<=0&&(g.DOM.setStyle(t,"opacity",0),!g.isNothing(i))?i(t):g.Browser.isCSSTransformSupported?this._applyTransition(t,"opacity",0,e,i,s):u.jQuery(t).fadeTo(e,0,i)},slideBy:function(t,e,i,s,o,n){var a={};e=g.coalesce(e,0),i=g.coalesce(i,0),n=g.coalesce(n,"ease-out"),a[this._transitionPrefix+"Property"]="all",a[this._transitionPrefix+"Delay"]="0",0===s?(a[this._transitionPrefix+"Duration"]="",a[this._transitionPrefix+"TimingFunction"]=""):(a[this._transitionPrefix+"Duration"]=s+"ms",a[this._transitionPrefix+"TimingFunction"]=g.coalesce(n,"ease-out"),g.Events.add(t,this._transitionEndLabel,this._getTransitionEndHandler())),a[this._transformLabel]=g.Browser.is3dSupported?"translate3d("+e+"px, "+i+"px, 0px)":"translate("+e+"px, "+i+"px)",g.isNothing(o)||(t.cclallcallback=o),g.DOM.setStyle(t,a),0===s&&u.setTimeout(function(){this._leaveTransforms(t)}.bind(this),this._applyTransitionDelay)},resetTranslate:function(t){var e={};e[this._transformLabel]=e[this._transformLabel]=g.Browser.is3dSupported?"translate3d(0px, 0px, 0px)":"translate(0px, 0px)",g.DOM.setStyle(t,e)},_applyTransition:function(t,e,i,s,o,n){var a={};n=g.coalesce(n,"ease-in"),a[this._transitionPrefix+"Property"]=e,a[this._transitionPrefix+"Duration"]=s+"ms",a[this._transitionPrefix+"TimingFunction"]=n,a[this._transitionPrefix+"Delay"]="0",g.Events.add(t,this._transitionEndLabel,this._getTransitionEndHandler()),g.DOM.setStyle(t,a),g.isNothing(o)||(t["ccl"+e+"callback"]=o),u.setTimeout(function(){g.DOM.setStyle(t,e,i)},this._applyTransitionDelay)},_onTransitionEnd:function(t){g.Events.remove(t.currentTarget,this._transitionEndLabel,this._getTransitionEndHandler()),this._leaveTransforms(t.currentTarget)},_leaveTransforms:function(t){var e,i,s,o,n,a=t.style[this._transitionPrefix+"Property"],r=""!==a?"ccl"+a+"callback":"cclallcallback",h=g.coalesce(t.style.webkitTransform,t.style.MozTransform,t.style.transform),l=u.parseInt(g.DOM.getStyle(t,"left"),0),d=u.parseInt(g.DOM.getStyle(t,"top"),0),c={};""!==h&&(i=g.Browser.is3dSupported?h.match(/translate3d\((.*?)\)/):h.match(/translate\((.*?)\)/),g.isNothing(i)||(s=i[1].split(", "),o=u.parseInt(s[0],0),n=u.parseInt(s[1],0))),c[this._transitionPrefix+"Property"]="",c[this._transitionPrefix+"Duration"]="",c[this._transitionPrefix+"TimingFunction"]="",c[this._transitionPrefix+"Delay"]="",g.DOM.setStyle(t,c),u.setTimeout(function(){g.isNothing(s)||((c={})[this._transformLabel]="",c.left=l+o+"px",c.top=d+n+"px",g.DOM.setStyle(t,c)),g.isNothing(t[r])||(e=t[r],delete t[r],e(t))}.bind(this),this._applyTransitionDelay)}}})}(window,window.Code.Util),function(t,e,i){i.registerNamespace("Code.Util.TouchElement"),i.TouchElement.EventTypes={onTouch:"CodeUtilTouchElementOnTouch"},i.TouchElement.ActionTypes={touchStart:"touchStart",touchMove:"touchMove",touchEnd:"touchEnd",touchMoveEnd:"touchMoveEnd",tap:"tap",doubleTap:"doubleTap",swipeLeft:"swipeLeft",swipeRight:"swipeRight",swipeUp:"swipeUp",swipeDown:"swipeDown",gestureStart:"gestureStart",gestureChange:"gestureChange",gestureEnd:"gestureEnd"}}(window,window.klass,window.Code.Util),function(o,t,n){n.registerNamespace("Code.Util.TouchElement"),n.TouchElement.TouchElementClass=t({el:null,captureSettings:null,touchStartPoint:null,touchEndPoint:null,touchStartTime:null,doubleTapTimeout:null,touchStartHandler:null,touchMoveHandler:null,touchEndHandler:null,mouseDownHandler:null,mouseMoveHandler:null,mouseUpHandler:null,mouseOutHandler:null,gestureStartHandler:null,gestureChangeHandler:null,gestureEndHandler:null,swipeThreshold:null,swipeTimeThreshold:null,doubleTapSpeed:null,dispose:function(){var t;for(t in this.removeEventHandlers(),this)n.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(t,e){this.el=t,this.captureSettings={swipe:!1,move:!1,gesture:!1,doubleTap:!1,preventDefaultTouchEvents:!0},n.extend(this.captureSettings,e),this.swipeThreshold=50,this.swipeTimeThreshold=250,this.doubleTapSpeed=250,this.touchStartPoint={x:0,y:0},this.touchEndPoint={x:0,y:0}},addEventHandlers:function(){n.isNothing(this.touchStartHandler)&&(this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=this.onTouchMove.bind(this),this.touchEndHandler=this.onTouchEnd.bind(this),this.mouseDownHandler=this.onMouseDown.bind(this),this.mouseMoveHandler=this.onMouseMove.bind(this),this.mouseUpHandler=this.onMouseUp.bind(this),this.mouseOutHandler=this.onMouseOut.bind(this),this.gestureStartHandler=this.onGestureStart.bind(this),this.gestureChangeHandler=this.onGestureChange.bind(this),this.gestureEndHandler=this.onGestureEnd.bind(this)),n.Events.add(this.el,"touchstart",this.touchStartHandler),this.captureSettings.move&&n.Events.add(this.el,"touchmove",this.touchMoveHandler),n.Events.add(this.el,"touchend",this.touchEndHandler),n.Events.add(this.el,"mousedown",this.mouseDownHandler),n.Browser.isGestureSupported&&this.captureSettings.gesture&&(n.Events.add(this.el,"gesturestart",this.gestureStartHandler),n.Events.add(this.el,"gesturechange",this.gestureChangeHandler),n.Events.add(this.el,"gestureend",this.gestureEndHandler))},removeEventHandlers:function(){n.Events.remove(this.el,"touchstart",this.touchStartHandler),this.captureSettings.move&&n.Events.remove(this.el,"touchmove",this.touchMoveHandler),n.Events.remove(this.el,"touchend",this.touchEndHandler),n.Events.remove(this.el,"mousedown",this.mouseDownHandler),n.Browser.isGestureSupported&&this.captureSettings.gesture&&(n.Events.remove(this.el,"gesturestart",this.gestureStartHandler),n.Events.remove(this.el,"gesturechange",this.gestureChangeHandler),n.Events.remove(this.el,"gestureend",this.gestureEndHandler))},getTouchPoint:function(t){return{x:t[0].pageX,y:t[0].pageY}},fireTouchEvent:function(t){var e,i,s;if(e=this.touchEndPoint.x-this.touchStartPoint.x,i=this.touchEndPoint.y-this.touchStartPoint.y,s=Math.sqrt(e*e+i*i),this.captureSettings.swipe&&new Date-this.touchStartTime<=this.swipeTimeThreshold){if(o.Math.abs(e)>=this.swipeThreshold)return void n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:e<0?n.TouchElement.ActionTypes.swipeLeft:n.TouchElement.ActionTypes.swipeRight,targetEl:t.target,currentTargetEl:t.currentTarget});if(o.Math.abs(i)>=this.swipeThreshold)return void n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:i<0?n.TouchElement.ActionTypes.swipeUp:n.TouchElement.ActionTypes.swipeDown,targetEl:t.target,currentTargetEl:t.currentTarget})}1<s?n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchMoveEnd,point:this.touchEndPoint,targetEl:t.target,currentTargetEl:t.currentTarget}):this.captureSettings.doubleTap?n.isNothing(this.doubleTapTimeout)?this.doubleTapTimeout=o.setTimeout(function(){this.doubleTapTimeout=null,n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:n.TouchElement.ActionTypes.tap,targetEl:t.target,currentTargetEl:t.currentTarget})}.bind(this),this.doubleTapSpeed):(o.clearTimeout(this.doubleTapTimeout),this.doubleTapTimeout=null,n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:n.TouchElement.ActionTypes.doubleTap,targetEl:t.target,currentTargetEl:t.currentTarget})):n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:n.TouchElement.ActionTypes.tap,targetEl:t.target,currentTargetEl:t.currentTarget})},onTouchStart:function(t){this.captureSettings.preventDefaultTouchEvents&&t.preventDefault(),n.Events.remove(this.el,"mousedown",this.mouseDownHandler);var e=n.Events.getTouchEvent(t).touches;1<e.length&&this.captureSettings.gesture?this.isGesture=!0:(this.touchStartTime=new Date,this.isGesture=!1,this.touchStartPoint=this.getTouchPoint(e),n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:t.target,currentTargetEl:t.currentTarget}))},onTouchMove:function(t){if(this.captureSettings.preventDefaultTouchEvents&&t.preventDefault(),!this.isGesture||!this.captureSettings.gesture){var e=n.Events.getTouchEvent(t).touches;n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchMove,point:this.getTouchPoint(e),targetEl:t.target,currentTargetEl:t.currentTarget})}},onTouchEnd:function(t){if(!this.isGesture||!this.captureSettings.gesture){this.captureSettings.preventDefaultTouchEvents&&t.preventDefault();var e=n.Events.getTouchEvent(t),i=n.isNothing(e.changedTouches)?e.touches:e.changedTouches;this.touchEndPoint=this.getTouchPoint(i),n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:t.target,currentTargetEl:t.currentTarget}),this.fireTouchEvent(t)}},onMouseDown:function(t){t.preventDefault(),n.Events.remove(this.el,"touchstart",this.mouseDownHandler),n.Events.remove(this.el,"touchmove",this.touchMoveHandler),n.Events.remove(this.el,"touchend",this.touchEndHandler),this.captureSettings.move&&n.Events.add(this.el,"mousemove",this.mouseMoveHandler),n.Events.add(this.el,"mouseup",this.mouseUpHandler),n.Events.add(this.el,"mouseout",this.mouseOutHandler),this.touchStartTime=new Date,this.isGesture=!1,this.touchStartPoint=n.Events.getMousePosition(t),n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:t.target,currentTargetEl:t.currentTarget})},onMouseMove:function(t){t.preventDefault(),n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchMove,point:n.Events.getMousePosition(t),targetEl:t.target,currentTargetEl:t.currentTarget})},onMouseUp:function(t){t.preventDefault(),this.captureSettings.move&&n.Events.remove(this.el,"mousemove",this.mouseMoveHandler),n.Events.remove(this.el,"mouseup",this.mouseUpHandler),n.Events.remove(this.el,"mouseout",this.mouseOutHandler),this.touchEndPoint=n.Events.getMousePosition(t),n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:t.target,currentTargetEl:t.currentTarget}),this.fireTouchEvent(t)},onMouseOut:function(t){var e=t.relatedTarget;this.el===e||n.DOM.isChildOf(e,this.el)||(t.preventDefault(),this.captureSettings.move&&n.Events.remove(this.el,"mousemove",this.mouseMoveHandler),n.Events.remove(this.el,"mouseup",this.mouseUpHandler),n.Events.remove(this.el,"mouseout",this.mouseOutHandler),this.touchEndPoint=n.Events.getMousePosition(t),n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:t.target,currentTargetEl:t.currentTarget}),this.fireTouchEvent(t))},onGestureStart:function(t){t.preventDefault();var e=n.Events.getTouchEvent(t);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.gestureStart,scale:e.scale,rotation:e.rotation,targetEl:t.target,currentTargetEl:t.currentTarget})},onGestureChange:function(t){t.preventDefault();var e=n.Events.getTouchEvent(t);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.gestureChange,scale:e.scale,rotation:e.rotation,targetEl:t.target,currentTargetEl:t.currentTarget})},onGestureEnd:function(t){t.preventDefault();var e=n.Events.getTouchEvent(t);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.gestureEnd,scale:e.scale,rotation:e.rotation,targetEl:t.target,currentTargetEl:t.currentTarget})}})}(window,window.klass,window.Code.Util),function(t,e,i){window.Code.Util.registerNamespace("Code.PhotoSwipe.Image"),t.Code.PhotoSwipe.Image.EventTypes={onLoad:"onLoad",onError:"onError"}}(window,window.klass),function(o,t,e){e.registerNamespace("Code.PhotoSwipe.Image");var i=o.Code.PhotoSwipe;i.Image.ImageClass=t({refObj:null,imageEl:null,src:null,caption:null,metaData:null,imageLoadHandler:null,imageErrorHandler:null,dispose:function(){var t;for(t in this.shrinkImage(),this)e.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(t,e,i,s){this.refObj=t,this.originalSrc=e,this.src=e,this.caption=i,this.metaData=s,this.imageEl=new o.Image,this.imageLoadHandler=this.onImageLoad.bind(this),this.imageErrorHandler=this.onImageError.bind(this)},load:function(){this.imageEl.originalSrc=e.coalesce(this.imageEl.originalSrc,""),this.imageEl.originalSrc!==this.src?(this.imageEl.isError=!1,this.imageEl.isLoading=!0,this.imageEl.naturalWidth=null,this.imageEl.naturalHeight=null,this.imageEl.isLandscape=!1,this.imageEl.onload=this.imageLoadHandler,this.imageEl.onerror=this.imageErrorHandler,this.imageEl.onabort=this.imageErrorHandler,this.imageEl.originalSrc=this.src,this.imageEl.src=this.src):this.imageEl.isError?e.Events.fire(this,{type:i.Image.EventTypes.onError,target:this}):e.Events.fire(this,{type:i.Image.EventTypes.onLoad,target:this})},shrinkImage:function(){e.isNothing(this.imageEl)||-1<this.imageEl.src.indexOf(this.src)&&(this.imageEl.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",e.isNothing(this.imageEl.parentNode)||e.DOM.removeChild(this.imageEl,this.imageEl.parentNode))},onImageLoad:function(t){this.imageEl.onload=null,this.imageEl.naturalWidth=e.coalesce(this.imageEl.naturalWidth,this.imageEl.width),this.imageEl.naturalHeight=e.coalesce(this.imageEl.naturalHeight,this.imageEl.height),this.imageEl.isLandscape=this.imageEl.naturalWidth>this.imageEl.naturalHeight,this.imageEl.isLoading=!1,e.Events.fire(this,{type:i.Image.EventTypes.onLoad,target:this})},onImageError:function(t){this.imageEl.onload=null,this.imageEl.onerror=null,this.imageEl.onabort=null,this.imageEl.isLoading=!1,this.imageEl.isError=!0,e.Events.fire(this,{type:i.Image.EventTypes.onError,target:this})}})}(window,window.klass,window.Code.Util),function(t,e,o){o.registerNamespace("Code.PhotoSwipe.Cache");var i=t.Code.PhotoSwipe;i.Cache.Mode={normal:"normal",aggressive:"aggressive"},i.Cache.Functions={getImageSource:function(t){return t.href},getImageCaption:function(t){if("IMG"===t.nodeName)return o.DOM.getAttribute(t,"alt");var e,i,s;for(e=0,i=t.childNodes.length;e<i;e++)if(s=t.childNodes[e],"IMG"===t.childNodes[e].nodeName)return o.DOM.getAttribute(s,"alt")},getImageMetaData:function(t){return{}}}}(window,window.klass,window.Code.Util),function(t,e,n){n.registerNamespace("Code.PhotoSwipe.Cache");var h=t.Code.PhotoSwipe;h.Cache.CacheClass=e({images:null,settings:null,dispose:function(){var t,e,i;if(!n.isNothing(this.images)){for(e=0,i=this.images.length;e<i;e++)this.images[e].dispose();this.images.length=0}for(t in this)n.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(t,e){var i,s,o,n,a,r;for(this.settings=e,this.images=[],i=0,s=t.length;i<s;i++)o=t[i],n=this.settings.getImageSource(o),a=this.settings.getImageCaption(o),r=this.settings.getImageMetaData(o),this.images.push(new h.Image.ImageClass(o,n,a,r))},getImages:function(t){var e,i,s,o=[];for(e=0,i=t.length;e<i;e++)s=this.images[t[e]],this.settings.cacheMode===h.Cache.Mode.aggressive&&(s.cacheDoNotShrink=!0),o.push(s);if(this.settings.cacheMode===h.Cache.Mode.aggressive)for(e=0,i=this.images.length;e<i;e++)s=this.images[e],n.objectHasProperty(s,"cacheDoNotShrink")?delete s.cacheDoNotShrink:s.shrinkImage();return o}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Image),function(t,e,i){window.Code.Util.registerNamespace("Code.PhotoSwipe.DocumentOverlay"),t.Code.PhotoSwipe.DocumentOverlay.CssClasses={documentOverlay:"ps-document-overlay"}}(window,window.klass),function(s,t,o){o.registerNamespace("Code.PhotoSwipe.DocumentOverlay");var e=s.Code.PhotoSwipe;e.DocumentOverlay.DocumentOverlayClass=t({el:null,settings:null,initialBodyHeight:null,dispose:function(){var t;for(t in o.Animation.stop(this.el),o.DOM.removeChild(this.el,this.el.parentNode),this)o.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(t){this.settings=t,this.el=o.DOM.createElement("div",{class:e.DocumentOverlay.CssClasses.documentOverlay},""),o.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,zIndex:this.settings.zIndex}),o.DOM.hide(this.el),this.settings.target===s?o.DOM.appendToBody(this.el):o.DOM.appendChild(this.el,this.settings.target),o.Animation.resetTranslate(this.el),this.initialBodyHeight=o.DOM.bodyOuterHeight()},resetPosition:function(){var t,e,i;this.settings.target===s?(t=o.DOM.windowWidth(),e=2*o.DOM.bodyOuterHeight(),i=this.settings.jQueryMobile?o.DOM.windowScrollTop()+"px":"0px",e<1&&(e=this.initialBodyHeight),o.DOM.windowHeight()>e&&(e=o.DOM.windowHeight())):(t=o.DOM.width(this.settings.target),e=o.DOM.height(this.settings.target),i="0px"),o.DOM.setStyle(this.el,{width:t,height:e,top:i})},fadeIn:function(t,e){this.resetPosition(),o.DOM.setStyle(this.el,"opacity",0),o.DOM.show(this.el),o.Animation.fadeIn(this.el,t,e)}})}(window,window.klass,window.Code.Util),function(t,e,i){window.Code.Util.registerNamespace("Code.PhotoSwipe.Carousel");var s=t.Code.PhotoSwipe;s.Carousel.EventTypes={onSlideByEnd:"PhotoSwipeCarouselOnSlideByEnd",onSlideshowStart:"PhotoSwipeCarouselOnSlideshowStart",onSlideshowStop:"PhotoSwipeCarouselOnSlideshowStop"},s.Carousel.CssClasses={carousel:"ps-carousel",content:"ps-carousel-content",item:"ps-carousel-item",itemLoading:"ps-carousel-item-loading",itemError:"ps-carousel-item-error"},s.Carousel.SlideByAction={previous:"previous",current:"current",next:"next"}}(window,window.klass),function(l,t,d){d.registerNamespace("Code.PhotoSwipe.Carousel");var c=l.Code.PhotoSwipe;c.Carousel.CarouselClass=t({el:null,contentEl:null,settings:null,cache:null,slideByEndHandler:null,currentCacheIndex:null,isSliding:null,isSlideshowActive:null,lastSlideByAction:null,touchStartPoint:null,touchStartPosition:null,imageLoadHandler:null,imageErrorHandler:null,slideshowTimeout:null,dispose:function(){var t,e,i;for(e=0,i=this.cache.images.length;e<i;e++)d.Events.remove(this.cache.images[e],c.Image.EventTypes.onLoad,this.imageLoadHandler),d.Events.remove(this.cache.images[e],c.Image.EventTypes.onError,this.imageErrorHandler);for(t in this.stopSlideshow(),d.Animation.stop(this.el),d.DOM.removeChild(this.el,this.el.parentNode),this)d.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(t,e){var i,s,o;for(this.cache=t,this.settings=e,this.slideByEndHandler=this.onSlideByEnd.bind(this),this.imageLoadHandler=this.onImageLoad.bind(this),this.imageErrorHandler=this.onImageError.bind(this),this.currentCacheIndex=0,this.isSliding=!1,this.isSlideshowActive=!1,this.cache.images.length<3&&(this.settings.loop=!1),this.el=d.DOM.createElement("div",{class:c.Carousel.CssClasses.carousel},""),d.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex}),d.DOM.hide(this.el),this.contentEl=d.DOM.createElement("div",{class:c.Carousel.CssClasses.content},""),d.DOM.setStyle(this.contentEl,{display:"block",position:"absolute",left:0,top:0}),d.DOM.appendChild(this.contentEl,this.el),s=t.images.length<3?t.images.length:3,i=0;i<s;i++)o=d.DOM.createElement("div",{class:c.Carousel.CssClasses.item+" "+c.Carousel.CssClasses.item+"-"+i},""),d.DOM.setAttribute(o,"style","float: left;"),d.DOM.setStyle(o,{display:"block",position:"relative",left:0,top:0,overflow:"hidden"}),0<this.settings.margin&&d.DOM.setStyle(o,{marginRight:this.settings.margin+"px"}),d.DOM.appendChild(o,this.contentEl);this.settings.target===l?d.DOM.appendToBody(this.el):d.DOM.appendChild(this.el,this.settings.target)},resetPosition:function(){var t,e,i,s,o,n,a,r,h;for(this.settings.target===l?(t=d.DOM.windowWidth(),e=d.DOM.windowHeight(),i=d.DOM.windowScrollTop()+"px"):(t=d.DOM.width(this.settings.target),e=d.DOM.height(this.settings.target),i="0px"),o=(0<this.settings.margin?t+this.settings.margin:t)*(s=d.DOM.find("."+c.Carousel.CssClasses.item,this.contentEl)).length,d.DOM.setStyle(this.el,{top:i,width:t,height:e}),d.DOM.setStyle(this.contentEl,{width:o,height:e}),n=0,a=s.length;n<a;n++)r=s[n],d.DOM.setStyle(r,{width:t,height:e}),h=d.DOM.find("img",r)[0],d.isNothing(h)||this.resetImagePosition(h);this.setContentLeftPosition()},resetImagePosition:function(t){if(!d.isNothing(t)){d.DOM.getAttribute(t,"src");var e,i,s,o,n,a=d.DOM.width(this.el),r=d.DOM.height(this.el);"fitNoUpscale"===this.settings.imageScaleMethod?(i=t.naturalWidth,s=t.naturalHeight,a<i&&(e=a/i,i=Math.round(i*e),s=Math.round(s*e)),r<s&&(e=r/s,s=Math.round(s*e),i=Math.round(i*e))):(e=t.isLandscape?a/t.naturalWidth:r/t.naturalHeight,i=Math.round(t.naturalWidth*e),s=Math.round(t.naturalHeight*e),"zoom"===this.settings.imageScaleMethod?(e=1,s<r?e=r/s:i<a&&(e=a/i),1!==e&&(i=Math.round(i*e),s=Math.round(s*e))):"fit"===this.settings.imageScaleMethod&&(e=1,a<i?e=a/i:r<s&&(e=r/s),1!==e&&(i=Math.round(i*e),s=Math.round(s*e)))),o=Math.round((r-s)/2)+"px",n=Math.round((a-i)/2)+"px",d.DOM.setStyle(t,{position:"absolute",width:i,height:s,top:o,left:n,display:"block"})}},setContentLeftPosition:function(){var t,e,i;t=this.settings.target===l?d.DOM.windowWidth():d.DOM.width(this.settings.target),e=this.getItemEls(),i=0,this.settings.loop?i=-1*(t+this.settings.margin):this.currentCacheIndex===this.cache.images.length-1?i=(e.length-1)*(t+this.settings.margin)*-1:0<this.currentCacheIndex&&(i=-1*(t+this.settings.margin)),d.DOM.setStyle(this.contentEl,{left:i+"px"})},show:function(t){this.currentCacheIndex=t,this.resetPosition(),this.setImages(!1),d.DOM.show(this.el),d.Animation.resetTranslate(this.contentEl);var e,i,s=this.getItemEls();for(e=0,i=s.length;e<i;e++)d.Animation.resetTranslate(s[e]);d.Events.fire(this,{type:c.Carousel.EventTypes.onSlideByEnd,target:this,action:c.Carousel.SlideByAction.current,cacheIndex:this.currentCacheIndex})},setImages:function(t){var e,i=this.getItemEls(),s=this.currentCacheIndex+1,o=this.currentCacheIndex-1;this.settings.loop?(s>this.cache.images.length-1&&(s=0),o<0&&(o=this.cache.images.length-1),e=this.cache.getImages([o,this.currentCacheIndex,s]),t||this.addCacheImageToItemEl(e[1],i[1]),this.addCacheImageToItemEl(e[2],i[2]),this.addCacheImageToItemEl(e[0],i[0])):1===i.length?t||(e=this.cache.getImages([this.currentCacheIndex]),this.addCacheImageToItemEl(e[0],i[0])):2===i.length?0===this.currentCacheIndex?(e=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1]),t||this.addCacheImageToItemEl(e[0],i[0]),this.addCacheImageToItemEl(e[1],i[1])):(e=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex]),t||this.addCacheImageToItemEl(e[1],i[1]),this.addCacheImageToItemEl(e[0],i[0])):0===this.currentCacheIndex?(e=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1,this.currentCacheIndex+2]),t||this.addCacheImageToItemEl(e[0],i[0]),this.addCacheImageToItemEl(e[1],i[1]),this.addCacheImageToItemEl(e[2],i[2])):(this.currentCacheIndex===this.cache.images.length-1?(e=this.cache.getImages([this.currentCacheIndex-2,this.currentCacheIndex-1,this.currentCacheIndex]),t||this.addCacheImageToItemEl(e[2],i[2]),this.addCacheImageToItemEl(e[1],i[1])):(e=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex,this.currentCacheIndex+1]),t||this.addCacheImageToItemEl(e[1],i[1]),this.addCacheImageToItemEl(e[2],i[2])),this.addCacheImageToItemEl(e[0],i[0]))},addCacheImageToItemEl:function(t,e){d.DOM.removeClass(e,c.Carousel.CssClasses.itemError),d.DOM.addClass(e,c.Carousel.CssClasses.itemLoading),d.DOM.removeChildren(e),d.DOM.setStyle(t.imageEl,{display:"none"}),d.DOM.appendChild(t.imageEl,e),d.Animation.resetTranslate(t.imageEl),d.Events.add(t,c.Image.EventTypes.onLoad,this.imageLoadHandler),d.Events.add(t,c.Image.EventTypes.onError,this.imageErrorHandler),t.load()},slideCarousel:function(t,e,i){var s,o,n;if(!this.isSliding&&(s=this.settings.target===l?d.DOM.windowWidth()+this.settings.margin:d.DOM.width(this.settings.target)+this.settings.margin,i=d.coalesce(i,this.settings.slideSpeed),!(l.Math.abs(o)<1))){switch(e){case d.TouchElement.ActionTypes.swipeLeft:n=-1*s;break;case d.TouchElement.ActionTypes.swipeRight:n=s;break;default:o=t.x-this.touchStartPoint.x,n=l.Math.abs(o)>s/2?0<o?s:-1*s:0}this.lastSlideByAction=n<0?c.Carousel.SlideByAction.next:0<n?c.Carousel.SlideByAction.previous:c.Carousel.SlideByAction.current,this.settings.loop||(this.lastSlideByAction===c.Carousel.SlideByAction.previous&&0===this.currentCacheIndex||this.lastSlideByAction===c.Carousel.SlideByAction.next&&this.currentCacheIndex===this.cache.images.length-1)&&(n=0,this.lastSlideByAction=c.Carousel.SlideByAction.current),this.isSliding=!0,this.doSlideCarousel(n,i)}},moveCarousel:function(t){this.isSliding||this.settings.enableDrag&&this.doMoveCarousel(t.x-this.touchStartPoint.x)},getItemEls:function(){return d.DOM.find("."+c.Carousel.CssClasses.item,this.contentEl)},previous:function(){this.stopSlideshow(),this.slideCarousel({x:0,y:0},d.TouchElement.ActionTypes.swipeRight,this.settings.nextPreviousSlideSpeed)},next:function(){this.stopSlideshow(),this.slideCarousel({x:0,y:0},d.TouchElement.ActionTypes.swipeLeft,this.settings.nextPreviousSlideSpeed)},slideshowNext:function(){this.slideCarousel({x:0,y:0},d.TouchElement.ActionTypes.swipeLeft)},startSlideshow:function(){this.stopSlideshow(),this.isSlideshowActive=!0,this.slideshowTimeout=l.setTimeout(this.slideshowNext.bind(this),this.settings.slideshowDelay),d.Events.fire(this,{type:c.Carousel.EventTypes.onSlideshowStart,target:this})},stopSlideshow:function(){d.isNothing(this.slideshowTimeout)||(l.clearTimeout(this.slideshowTimeout),this.slideshowTimeout=null,this.isSlideshowActive=!1,d.Events.fire(this,{type:c.Carousel.EventTypes.onSlideshowStop,target:this}))},onSlideByEnd:function(t){if(!d.isNothing(this.isSliding)){var e=this.getItemEls();this.isSliding=!1,this.lastSlideByAction===c.Carousel.SlideByAction.next?this.currentCacheIndex=this.currentCacheIndex+1:this.lastSlideByAction===c.Carousel.SlideByAction.previous&&(this.currentCacheIndex=this.currentCacheIndex-1),this.settings.loop?(this.lastSlideByAction===c.Carousel.SlideByAction.next?d.DOM.appendChild(e[0],this.contentEl):this.lastSlideByAction===c.Carousel.SlideByAction.previous&&d.DOM.insertBefore(e[e.length-1],e[0],this.contentEl),this.currentCacheIndex<0?this.currentCacheIndex=this.cache.images.length-1:this.currentCacheIndex===this.cache.images.length&&(this.currentCacheIndex=0)):3<this.cache.images.length&&(1<this.currentCacheIndex&&this.currentCacheIndex<this.cache.images.length-2?this.lastSlideByAction===c.Carousel.SlideByAction.next?d.DOM.appendChild(e[0],this.contentEl):this.lastSlideByAction===c.Carousel.SlideByAction.previous&&d.DOM.insertBefore(e[e.length-1],e[0],this.contentEl):1===this.currentCacheIndex?this.lastSlideByAction===c.Carousel.SlideByAction.previous&&d.DOM.insertBefore(e[e.length-1],e[0],this.contentEl):this.currentCacheIndex===this.cache.images.length-2&&this.lastSlideByAction===c.Carousel.SlideByAction.next&&d.DOM.appendChild(e[0],this.contentEl)),this.lastSlideByAction!==c.Carousel.SlideByAction.current&&(this.setContentLeftPosition(),this.setImages(!0)),d.Events.fire(this,{type:c.Carousel.EventTypes.onSlideByEnd,target:this,action:this.lastSlideByAction,cacheIndex:this.currentCacheIndex}),this.isSlideshowActive&&(this.lastSlideByAction!==c.Carousel.SlideByAction.current?this.startSlideshow():this.stopSlideshow())}},onTouch:function(t,e){switch(this.stopSlideshow(),t){case d.TouchElement.ActionTypes.touchStart:this.touchStartPoint=e,this.touchStartPosition={x:l.parseInt(d.DOM.getStyle(this.contentEl,"left"),0),y:l.parseInt(d.DOM.getStyle(this.contentEl,"top"),0)};break;case d.TouchElement.ActionTypes.touchMove:this.moveCarousel(e);break;case d.TouchElement.ActionTypes.touchMoveEnd:case d.TouchElement.ActionTypes.swipeLeft:case d.TouchElement.ActionTypes.swipeRight:this.slideCarousel(e,t);break;case d.TouchElement.ActionTypes.tap:case d.TouchElement.ActionTypes.doubleTap:}},onImageLoad:function(t){var e=t.target;d.isNothing(e.imageEl.parentNode)||(d.DOM.removeClass(e.imageEl.parentNode,c.Carousel.CssClasses.itemLoading),this.resetImagePosition(e.imageEl)),d.Events.remove(e,c.Image.EventTypes.onLoad,this.imageLoadHandler),d.Events.remove(e,c.Image.EventTypes.onError,this.imageErrorHandler)},onImageError:function(t){var e=t.target;d.isNothing(e.imageEl.parentNode)||(d.DOM.removeClass(e.imageEl.parentNode,c.Carousel.CssClasses.itemLoading),d.DOM.addClass(e.imageEl.parentNode,c.Carousel.CssClasses.itemError)),d.Events.remove(e,c.Image.EventTypes.onLoad,this.imageLoadHandler),d.Events.remove(e,c.Image.EventTypes.onError,this.imageErrorHandler)}})}(window,window.klass,window.Code.Util),function(o,t,n,e){n.registerNamespace("Code.PhotoSwipe.Carousel");var i=o.Code.PhotoSwipe;i.Carousel.CarouselClass=i.Carousel.CarouselClass.extend({getStartingPos:function(){var t=this.touchStartPosition;return n.isNothing(t)&&(t={x:o.parseInt(n.DOM.getStyle(this.contentEl,"left"),0),y:o.parseInt(n.DOM.getStyle(this.contentEl,"top"),0)}),t},doMoveCarousel:function(t){var e;n.Browser.isCSSTransformSupported?((e={})[n.Animation._transitionPrefix+"Property"]="all",e[n.Animation._transitionPrefix+"Duration"]="",e[n.Animation._transitionPrefix+"TimingFunction"]="",e[n.Animation._transitionPrefix+"Delay"]="0",e[n.Animation._transformLabel]=n.Browser.is3dSupported?"translate3d("+t+"px, 0px, 0px)":"translate("+t+"px, 0px)",n.DOM.setStyle(this.contentEl,e)):n.isNothing(o.jQuery)||o.jQuery(this.contentEl).stop().css("left",this.getStartingPos().x+t+"px")},doSlideCarousel:function(t,e){var i,s;if(e<=0)this.slideByEndHandler();else if(n.Browser.isCSSTransformSupported){if(0===(s=n.coalesce(this.contentEl.style.webkitTransform,this.contentEl.style.MozTransform,this.contentEl.style.transform,"")).indexOf("translate3d("+t))return void this.slideByEndHandler();if(0===s.indexOf("translate("+t))return void this.slideByEndHandler();n.Animation.slideBy(this.contentEl,t,0,e,this.slideByEndHandler,this.settings.slideTimingFunction)}else n.isNothing(o.jQuery)||(i={left:this.getStartingPos().x+t+"px"},"ease-out"===this.settings.animationTimingFunction&&(this.settings.animationTimingFunction="easeOutQuad"),n.isNothing(o.jQuery.easing[this.settings.animationTimingFunction])&&(this.settings.animationTimingFunction="linear"),o.jQuery(this.contentEl).animate(i,this.settings.slideSpeed,this.settings.animationTimingFunction,this.slideByEndHandler))}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.TouchElement),function(t,e,i){window.Code.Util.registerNamespace("Code.PhotoSwipe.Toolbar");var s=t.Code.PhotoSwipe;s.Toolbar.CssClasses={toolbar:"ps-toolbar",toolbarContent:"ps-toolbar-content",toolbarTop:"ps-toolbar-top",caption:"ps-caption",captionBottom:"ps-caption-bottom",captionContent:"ps-caption-content",close:"ps-toolbar-close",play:"ps-toolbar-play",previous:"ps-toolbar-previous",previousDisabled:"ps-toolbar-previous-disabled",next:"ps-toolbar-next",nextDisabled:"ps-toolbar-next-disabled"},s.Toolbar.ToolbarAction={close:"close",play:"play",next:"next",previous:"previous",none:"none"},s.Toolbar.EventTypes={onTap:"PhotoSwipeToolbarOnClick",onBeforeShow:"PhotoSwipeToolbarOnBeforeShow",onShow:"PhotoSwipeToolbarOnShow",onBeforeHide:"PhotoSwipeToolbarOnBeforeHide",onHide:"PhotoSwipeToolbarOnHide"},s.Toolbar.getToolbar=function(){return'<div class="'+s.Toolbar.CssClasses.close+'"><div class="'+s.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+s.Toolbar.CssClasses.play+'"><div class="'+s.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+s.Toolbar.CssClasses.previous+'"><div class="'+s.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+s.Toolbar.CssClasses.next+'"><div class="'+s.Toolbar.CssClasses.toolbarContent+'"></div></div>'}}(window,window.klass),function(s,t,o){o.registerNamespace("Code.PhotoSwipe.Toolbar");var n=s.Code.PhotoSwipe;n.Toolbar.ToolbarClass=t({toolbarEl:null,closeEl:null,playEl:null,previousEl:null,nextEl:null,captionEl:null,captionContentEl:null,currentCaption:null,settings:null,cache:null,timeout:null,isVisible:null,fadeOutHandler:null,touchStartHandler:null,touchMoveHandler:null,clickHandler:null,dispose:function(){var t;for(t in this.clearTimeout(),this.removeEventHandlers(),o.Animation.stop(this.toolbarEl),o.Animation.stop(this.captionEl),o.DOM.removeChild(this.toolbarEl,this.toolbarEl.parentNode),o.DOM.removeChild(this.captionEl,this.captionEl.parentNode),this)o.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(t,e){var i;this.settings=e,this.cache=t,this.isVisible=!1,this.fadeOutHandler=this.onFadeOut.bind(this),this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=this.onTouchMove.bind(this),this.clickHandler=this.onClick.bind(this),i=n.Toolbar.CssClasses.toolbar,this.settings.captionAndToolbarFlipPosition&&(i=i+" "+n.Toolbar.CssClasses.toolbarTop),this.toolbarEl=o.DOM.createElement("div",{class:i},this.settings.getToolbar()),o.DOM.setStyle(this.toolbarEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex}),this.settings.target===s?o.DOM.appendToBody(this.toolbarEl):o.DOM.appendChild(this.toolbarEl,this.settings.target),o.DOM.hide(this.toolbarEl),this.closeEl=o.DOM.find("."+n.Toolbar.CssClasses.close,this.toolbarEl)[0],this.settings.preventHide&&!o.isNothing(this.closeEl)&&o.DOM.hide(this.closeEl),this.playEl=o.DOM.find("."+n.Toolbar.CssClasses.play,this.toolbarEl)[0],this.settings.preventSlideshow&&!o.isNothing(this.playEl)&&o.DOM.hide(this.playEl),this.nextEl=o.DOM.find("."+n.Toolbar.CssClasses.next,this.toolbarEl)[0],this.previousEl=o.DOM.find("."+n.Toolbar.CssClasses.previous,this.toolbarEl)[0],i=n.Toolbar.CssClasses.caption,this.settings.captionAndToolbarFlipPosition&&(i=i+" "+n.Toolbar.CssClasses.captionBottom),this.captionEl=o.DOM.createElement("div",{class:i},""),o.DOM.setStyle(this.captionEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex}),this.settings.target===s?o.DOM.appendToBody(this.captionEl):o.DOM.appendChild(this.captionEl,this.settings.target),o.DOM.hide(this.captionEl),this.captionContentEl=o.DOM.createElement("div",{class:n.Toolbar.CssClasses.captionContent},""),o.DOM.appendChild(this.captionContentEl,this.captionEl),this.addEventHandlers()},resetPosition:function(){var t,e,i;this.settings.target===s?(this.settings.captionAndToolbarFlipPosition?(e=o.DOM.windowScrollTop(),i=o.DOM.windowScrollTop()+o.DOM.windowHeight()-o.DOM.height(this.captionEl)):(e=o.DOM.windowScrollTop()+o.DOM.windowHeight()-o.DOM.height(this.toolbarEl),i=o.DOM.windowScrollTop()),t=o.DOM.windowWidth()):(this.settings.captionAndToolbarFlipPosition?(e="0",i=o.DOM.height(this.settings.target)-o.DOM.height(this.captionEl)):(e=o.DOM.height(this.settings.target)-o.DOM.height(this.toolbarEl),i=0),t=o.DOM.width(this.settings.target)),o.DOM.setStyle(this.toolbarEl,{top:e+"px",width:t}),o.DOM.setStyle(this.captionEl,{top:i+"px",width:t})},toggleVisibility:function(t){this.isVisible?this.fadeOut():this.show(t)},show:function(t){o.Animation.stop(this.toolbarEl),o.Animation.stop(this.captionEl),this.resetPosition(),this.setToolbarStatus(t),o.Events.fire(this,{type:n.Toolbar.EventTypes.onBeforeShow,target:this}),this.showToolbar(),this.setCaption(t),this.showCaption(),this.isVisible=!0,this.setTimeout(),o.Events.fire(this,{type:n.Toolbar.EventTypes.onShow,target:this})},setTimeout:function(){0<this.settings.captionAndToolbarAutoHideDelay&&(this.clearTimeout(),this.timeout=s.setTimeout(this.fadeOut.bind(this),this.settings.captionAndToolbarAutoHideDelay))},clearTimeout:function(){o.isNothing(this.timeout)||(s.clearTimeout(this.timeout),this.timeout=null)},fadeOut:function(){this.clearTimeout(),o.Events.fire(this,{type:n.Toolbar.EventTypes.onBeforeHide,target:this}),o.Animation.fadeOut(this.toolbarEl,this.settings.fadeOutSpeed),o.Animation.fadeOut(this.captionEl,this.settings.fadeOutSpeed,this.fadeOutHandler),this.isVisible=!1},addEventHandlers:function(){o.Browser.isTouchSupported&&(o.Browser.blackberry||o.Events.add(this.toolbarEl,"touchstart",this.touchStartHandler),o.Events.add(this.toolbarEl,"touchmove",this.touchMoveHandler),o.Events.add(this.captionEl,"touchmove",this.touchMoveHandler)),o.Events.add(this.toolbarEl,"click",this.clickHandler)},removeEventHandlers:function(){o.Browser.isTouchSupported&&(o.Browser.blackberry||o.Events.remove(this.toolbarEl,"touchstart",this.touchStartHandler),o.Events.remove(this.toolbarEl,"touchmove",this.touchMoveHandler),o.Events.remove(this.captionEl,"touchmove",this.touchMoveHandler)),o.Events.remove(this.toolbarEl,"click",this.clickHandler)},handleTap:function(t){var e;this.clearTimeout(),t.target===this.nextEl||o.DOM.isChildOf(t.target,this.nextEl)?e=n.Toolbar.ToolbarAction.next:t.target===this.previousEl||o.DOM.isChildOf(t.target,this.previousEl)?e=n.Toolbar.ToolbarAction.previous:t.target===this.closeEl||o.DOM.isChildOf(t.target,this.closeEl)?e=n.Toolbar.ToolbarAction.close:(t.target===this.playEl||o.DOM.isChildOf(t.target,this.playEl))&&(e=n.Toolbar.ToolbarAction.play),this.setTimeout(),o.isNothing(e)&&(e=n.Toolbar.ToolbarAction.none),o.Events.fire(this,{type:n.Toolbar.EventTypes.onTap,target:this,action:e,tapTarget:t.target})},setCaption:function(t){o.DOM.removeChildren(this.captionContentEl),this.currentCaption=o.coalesce(this.cache.images[t].caption," "),o.isObject(this.currentCaption)?o.DOM.appendChild(this.currentCaption,this.captionContentEl):(""===this.currentCaption&&(this.currentCaption=" "),o.DOM.appendText(this.currentCaption,this.captionContentEl)),this.currentCaption=" "===this.currentCaption?"":this.currentCaption,this.resetPosition()},showToolbar:function(){o.DOM.setStyle(this.toolbarEl,{opacity:this.settings.captionAndToolbarOpacity}),o.DOM.show(this.toolbarEl)},showCaption:function(){!(""===this.currentCaption||this.captionContentEl.childNodes.length<1)||this.settings.captionAndToolbarShowEmptyCaptions?(o.DOM.setStyle(this.captionEl,{opacity:this.settings.captionAndToolbarOpacity}),o.DOM.show(this.captionEl)):o.DOM.hide(this.captionEl)},setToolbarStatus:function(t){this.settings.loop||(o.DOM.removeClass(this.previousEl,n.Toolbar.CssClasses.previousDisabled),o.DOM.removeClass(this.nextEl,n.Toolbar.CssClasses.nextDisabled),0<t&&t<this.cache.images.length-1||(0===t&&(o.isNothing(this.previousEl)||o.DOM.addClass(this.previousEl,n.Toolbar.CssClasses.previousDisabled)),t===this.cache.images.length-1&&(o.isNothing(this.nextEl)||o.DOM.addClass(this.nextEl,n.Toolbar.CssClasses.nextDisabled))))},onFadeOut:function(){o.DOM.hide(this.toolbarEl),o.DOM.hide(this.captionEl),o.Events.fire(this,{type:n.Toolbar.EventTypes.onHide,target:this})},onTouchStart:function(t){t.preventDefault(),o.Events.remove(this.toolbarEl,"click",this.clickHandler),this.handleTap(t)},onTouchMove:function(t){t.preventDefault()},onClick:function(t){t.preventDefault(),this.handleTap(t)}})}(window,window.klass,window.Code.Util),function(t,e,i){window.Code.Util.registerNamespace("Code.PhotoSwipe.UILayer"),t.Code.PhotoSwipe.UILayer.CssClasses={uiLayer:"ps-uilayer"}}(window,window.klass),function(e,t,i){i.registerNamespace("Code.PhotoSwipe.UILayer");var s=e.Code.PhotoSwipe;s.UILayer.UILayerClass=i.TouchElement.TouchElementClass.extend({el:null,settings:null,dispose:function(){var t;for(t in this.removeEventHandlers(),i.DOM.removeChild(this.el,this.el.parentNode),this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(t){this.settings=t,this.el=i.DOM.createElement("div",{class:s.UILayer.CssClasses.uiLayer},""),i.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex,opacity:0}),i.DOM.hide(this.el),this.settings.target===e?i.DOM.appendToBody(this.el):i.DOM.appendChild(this.el,this.settings.target),this.supr(this.el,{swipe:!0,move:!0,gesture:i.Browser.iOS,doubleTap:!0,preventDefaultTouchEvents:this.settings.preventDefaultTouchEvents})},resetPosition:function(){this.settings.target===e?i.DOM.setStyle(this.el,{top:i.DOM.windowScrollTop()+"px",width:i.DOM.windowWidth(),height:i.DOM.windowHeight()}):i.DOM.setStyle(this.el,{top:"0px",width:i.DOM.width(this.settings.target),height:i.DOM.height(this.settings.target)})},show:function(){this.resetPosition(),i.DOM.show(this.el),this.addEventHandlers()},addEventHandlers:function(){this.supr()},removeEventHandlers:function(){this.supr()}})}(window,window.klass,window.Code.Util),function(t,e,i){window.Code.Util.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var s=t.Code.PhotoSwipe;s.ZoomPanRotate.CssClasses={zoomPanRotate:"ps-zoom-pan-rotate"},s.ZoomPanRotate.EventTypes={onTransform:"PhotoSwipeZoomPanRotateOnTransform"}}(window,window.klass),function(r,t,h){h.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var l=r.Code.PhotoSwipe;l.ZoomPanRotate.ZoomPanRotateClass=t({el:null,settings:null,containerEl:null,imageEl:null,transformSettings:null,panStartingPoint:null,transformEl:null,dispose:function(){var t;for(t in h.DOM.removeChild(this.el,this.el.parentNode),this)h.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(t,e,i){var s,o,n,a;this.settings=t,this.settings.target===r?(s=document.body,o=h.DOM.windowWidth(),n=h.DOM.windowHeight(),a=h.DOM.windowScrollTop()+"px"):(s=this.settings.target,o=h.DOM.width(s),n=h.DOM.height(s),a="0px"),this.imageEl=e.imageEl.cloneNode(!1),h.DOM.setStyle(this.imageEl,{zIndex:1}),this.transformSettings={startingScale:1,scale:1,startingRotation:0,rotation:0,startingTranslateX:0,startingTranslateY:0,translateX:0,translateY:0},this.el=h.DOM.createElement("div",{class:l.ZoomPanRotate.CssClasses.zoomPanRotate},""),h.DOM.setStyle(this.el,{left:0,top:a,position:"absolute",width:o,height:n,zIndex:this.settings.zIndex,display:"block"}),h.DOM.insertBefore(this.el,i.el,s),h.Browser.iOS?(this.containerEl=h.DOM.createElement("div","",""),h.DOM.setStyle(this.containerEl,{left:0,top:0,width:o,height:n,position:"absolute",zIndex:1}),h.DOM.appendChild(this.imageEl,this.containerEl),h.DOM.appendChild(this.containerEl,this.el),h.Animation.resetTranslate(this.containerEl),h.Animation.resetTranslate(this.imageEl),this.transformEl=this.containerEl):(h.DOM.appendChild(this.imageEl,this.el),this.transformEl=this.imageEl)},setStartingTranslateFromCurrentTransform:function(){var t,e=h.coalesce(this.transformEl.style.webkitTransform,this.transformEl.style.MozTransform,this.transformEl.style.transform);h.isNothing(e)||(t=e.match(/translate\((.*?)\)/),h.isNothing(t)||(t=t[1].split(", "),this.transformSettings.startingTranslateX=r.parseInt(t[0],10),this.transformSettings.startingTranslateY=r.parseInt(t[1],10)))},getScale:function(t){var e=this.transformSettings.startingScale*t;return 0!==this.settings.minUserZoom&&e<this.settings.minUserZoom?e=this.settings.minUserZoom:0!==this.settings.maxUserZoom&&e>this.settings.maxUserZoom&&(e=this.settings.maxUserZoom),e},setStartingScaleAndRotation:function(t,e){this.transformSettings.startingScale=this.getScale(t),this.transformSettings.startingRotation=(this.transformSettings.startingRotation+e)%360},zoomRotate:function(t,e){this.transformSettings.scale=this.getScale(t),this.transformSettings.rotation=this.transformSettings.startingRotation+e,this.applyTransform()},panStart:function(t){this.setStartingTranslateFromCurrentTransform(),this.panStartingPoint={x:t.x,y:t.y}},pan:function(t){var e=t.x-this.panStartingPoint.x,i=t.y-this.panStartingPoint.y,s=e/this.transformSettings.scale,o=i/this.transformSettings.scale;this.transformSettings.translateX=this.transformSettings.startingTranslateX+s,this.transformSettings.translateY=this.transformSettings.startingTranslateY+o,this.applyTransform()},zoomAndPanToPoint:function(t,e){if(this.settings.target===r){this.panStart({x:h.DOM.windowWidth()/2,y:h.DOM.windowHeight()/2});var i=e.x-this.panStartingPoint.x,s=e.y-this.panStartingPoint.y,o=i/this.transformSettings.scale,n=s/this.transformSettings.scale;this.transformSettings.translateX=-1*(this.transformSettings.startingTranslateX+o),this.transformSettings.translateY=-1*(this.transformSettings.startingTranslateY+n)}this.setStartingScaleAndRotation(t,0),this.transformSettings.scale=this.transformSettings.startingScale,this.transformSettings.rotation=0,this.applyTransform()},applyTransform:function(){var t=this.transformSettings.rotation%360,e=r.parseInt(this.transformSettings.translateX,10),i=r.parseInt(this.transformSettings.translateY,10),s="scale("+this.transformSettings.scale+") rotate("+t+"deg) translate("+e+"px, "+i+"px)";h.DOM.setStyle(this.transformEl,{webkitTransform:s,MozTransform:s,msTransform:s,transform:s}),h.Events.fire(this,{target:this,type:l.ZoomPanRotate.EventTypes.onTransform,scale:this.transformSettings.scale,rotation:this.transformSettings.rotation,rotationDegs:t,translateX:e,translateY:i})}})}(window,window.klass,window.Code.Util),function(t,r){r.registerNamespace("Code.PhotoSwipe");var h=t.Code.PhotoSwipe;h.CssClasses={buildingBody:"ps-building",activeBody:"ps-active"},h.EventTypes={onBeforeShow:"PhotoSwipeOnBeforeShow",onShow:"PhotoSwipeOnShow",onBeforeHide:"PhotoSwipeOnBeforeHide",onHide:"PhotoSwipeOnHide",onDisplayImage:"PhotoSwipeOnDisplayImage",onResetPosition:"PhotoSwipeOnResetPosition",onSlideshowStart:"PhotoSwipeOnSlideshowStart",onSlideshowStop:"PhotoSwipeOnSlideshowStop",onTouch:"PhotoSwipeOnTouch",onBeforeCaptionAndToolbarShow:"PhotoSwipeOnBeforeCaptionAndToolbarShow",onCaptionAndToolbarShow:"PhotoSwipeOnCaptionAndToolbarShow",onBeforeCaptionAndToolbarHide:"PhotoSwipeOnBeforeCaptionAndToolbarHide",onCaptionAndToolbarHide:"PhotoSwipeOnCaptionAndToolbarHide",onToolbarTap:"PhotoSwipeOnToolbarTap",onBeforeZoomPanRotateShow:"PhotoSwipeOnBeforeZoomPanRotateShow",onZoomPanRotateShow:"PhotoSwipeOnZoomPanRotateShow",onBeforeZoomPanRotateHide:"PhotoSwipeOnBeforeZoomPanRotateHide",onZoomPanRotateHide:"PhotoSwipeOnZoomPanRotateHide",onZoomPanRotateTransform:"PhotoSwipeOnZoomPanRotateTransform"},h.instances=[],h.activeInstances=[],h.setActivateInstance=function(t){if(-1<r.arrayIndexOf(t.settings.target,h.activeInstances,"target"))throw"Code.PhotoSwipe.activateInstance: Unable to active instance as another instance is already active for this target";h.activeInstances.push({target:t.settings.target,instance:t})},h.unsetActivateInstance=function(t){var e=r.arrayIndexOf(t,h.activeInstances,"instance");h.activeInstances.splice(e,1)},h.attach=function(t,e,i){var s,o,n,a;for(n=h.createInstance(t,e,i),s=0,o=t.length;s<o;s++)a=t[s],r.isNothing(a.nodeType)||1===a.nodeType&&(a.__photoSwipeClickHandler=h.onTriggerElementClick.bind(n),r.Events.remove(a,"click",a.__photoSwipeClickHandler),r.Events.add(a,"click",a.__photoSwipeClickHandler));return n},t.jQuery&&(t.jQuery.fn.photoSwipe=function(t,e){return h.attach(this,t,e)}),h.detatch=function(t){var e,i,s;for(e=0,i=t.originalImages.length;e<i;e++)s=t.originalImages[e],r.isNothing(s.nodeType)||1===s.nodeType&&(r.Events.remove(s,"click",s.__photoSwipeClickHandler),delete s.__photoSwipeClickHandler);h.disposeInstance(t)},h.createInstance=function(t,e,i){var s;if(r.isNothing(t))throw"Code.PhotoSwipe.attach: No images passed.";if(!r.isLikeArray(t))throw"Code.PhotoSwipe.createInstance: Images must be an array of elements or image urls.";if(t.length<1)throw"Code.PhotoSwipe.createInstance: No images to passed.";if(e=r.coalesce(e,{}),s=h.getInstance(i),!r.isNothing(s))throw'Code.PhotoSwipe.createInstance: Instance with id "'+i+' already exists."';return s=new h.PhotoSwipeClass(t,e,i),h.instances.push(s),s},h.disposeInstance=function(t){var e=h.getInstanceIndex(t);if(e<0)throw"Code.PhotoSwipe.disposeInstance: Unable to find instance to dispose.";t.dispose(),h.instances.splice(e,1),t=null},h.onTriggerElementClick=function(t){t.preventDefault();this.show(t.currentTarget)},h.getInstance=function(t){var e,i,s;for(e=0,i=h.instances.length;e<i;e++)if((s=h.instances[e]).id===t)return s;return null},h.getInstanceIndex=function(t){var e,i,s=-1;for(e=0,i=h.instances.length;e<i;e++)if(h.instances[e]===t){s=e;break}return s}}(window,window.Code.Util),function(a,t,r,o,e,i,s,n,h){r.registerNamespace("Code.PhotoSwipe");var l=a.Code.PhotoSwipe;l.PhotoSwipeClass=t({id:null,settings:null,isBackEventSupported:null,backButtonClicked:null,currentIndex:null,originalImages:null,mouseWheelStartTime:null,windowDimensions:null,cache:null,documentOverlay:null,carousel:null,uiLayer:null,toolbar:null,zoomPanRotate:null,windowOrientationChangeHandler:null,windowScrollHandler:null,windowHashChangeHandler:null,keyDownHandler:null,windowOrientationEventName:null,uiLayerTouchHandler:null,carouselSlideByEndHandler:null,carouselSlideshowStartHandler:null,carouselSlideshowStopHandler:null,toolbarTapHandler:null,toolbarBeforeShowHandler:null,toolbarShowHandler:null,toolbarBeforeHideHandler:null,toolbarHideHandler:null,mouseWheelHandler:null,zoomPanRotateTransformHandler:null,_isResettingPosition:null,_uiWebViewResetPositionTimeout:null,dispose:function(){var t;for(t in r.Events.remove(this,l.EventTypes.onBeforeShow),r.Events.remove(this,l.EventTypes.onShow),r.Events.remove(this,l.EventTypes.onBeforeHide),r.Events.remove(this,l.EventTypes.onHide),r.Events.remove(this,l.EventTypes.onDisplayImage),r.Events.remove(this,l.EventTypes.onResetPosition),r.Events.remove(this,l.EventTypes.onSlideshowStart),r.Events.remove(this,l.EventTypes.onSlideshowStop),r.Events.remove(this,l.EventTypes.onTouch),r.Events.remove(this,l.EventTypes.onBeforeCaptionAndToolbarShow),r.Events.remove(this,l.EventTypes.onCaptionAndToolbarShow),r.Events.remove(this,l.EventTypes.onBeforeCaptionAndToolbarHide),r.Events.remove(this,l.EventTypes.onCaptionAndToolbarHide),r.Events.remove(this,l.EventTypes.onZoomPanRotateTransform),this.removeEventHandlers(),r.isNothing(this.documentOverlay)||this.documentOverlay.dispose(),r.isNothing(this.carousel)||this.carousel.dispose(),r.isNothing(this.uiLayer)||this.uiLayer.dispose(),r.isNothing(this.toolbar)||this.toolbar.dispose(),this.destroyZoomPanRotate(),r.isNothing(this.cache)||this.cache.dispose(),this)r.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(t,e,i){var s;r.isNothing(i)?this.id="PhotoSwipe"+(new Date).getTime().toString():this.id=i,this.originalImages=t,r.Browser.android&&!r.Browser.firefox&&2.1<=a.navigator.userAgent.match(/Android (\d+.\d+)/).toString().replace(/^.*\,/,"")&&(this.isBackEventSupported=!0),this.isBackEventSupported||(this.isBackEventSupported=r.objectHasProperty(a,"onhashchange")),this.settings={fadeInSpeed:250,fadeOutSpeed:250,preventHide:!1,preventSlideshow:!1,zIndex:1e3,backButtonHideEnabled:!0,enableKeyboard:!0,enableMouseWheel:!0,mouseWheelSpeed:350,autoStartSlideshow:!1,jQueryMobile:!r.isNothing(a.jQuery)&&!r.isNothing(a.jQuery.mobile),jQueryMobileDialogHash:"&ui-state=dialog",enableUIWebViewRepositionTimeout:!1,uiWebViewResetPositionDelay:500,target:a,preventDefaultTouchEvents:!0,loop:!0,slideSpeed:250,nextPreviousSlideSpeed:0,enableDrag:!0,swipeThreshold:50,swipeTimeThreshold:250,slideTimingFunction:"ease-out",slideshowDelay:3e3,doubleTapSpeed:250,margin:20,imageScaleMethod:"fit",captionAndToolbarHide:!1,captionAndToolbarFlipPosition:!1,captionAndToolbarAutoHideDelay:5e3,captionAndToolbarOpacity:.8,captionAndToolbarShowEmptyCaptions:!0,getToolbar:l.Toolbar.getToolbar,allowUserZoom:!0,allowRotationOnUserZoom:!1,maxUserZoom:5,minUserZoom:.5,doubleTapZoomLevel:2.5,getImageSource:l.Cache.Functions.getImageSource,getImageCaption:l.Cache.Functions.getImageCaption,getImageMetaData:l.Cache.Functions.getImageMetaData,cacheMode:l.Cache.Mode.normal},r.extend(this.settings,e),this.settings.target!==a&&("relative"===(s=r.DOM.getStyle(this.settings.target,"position"))&&"absolute"===s||r.DOM.setStyle(this.settings.target,"position","relative")),this.settings.target!==a?(this.isBackEventSupported=!1,this.settings.backButtonHideEnabled=!1):this.settings.preventHide&&(this.settings.backButtonHideEnabled=!1),this.cache=new o.CacheClass(t,this.settings)},show:function(t){var e,i;if(this._isResettingPosition=!1,this.backButtonClicked=!1,r.isNumber(t))this.currentIndex=t;else for(this.currentIndex=-1,e=0,i=this.originalImages.length;e<i;e++)if(this.originalImages[e]===t){this.currentIndex=e;break}if(this.currentIndex<0||this.currentIndex>this.originalImages.length-1)throw"Code.PhotoSwipe.PhotoSwipeClass.show: Starting index out of range";this.isAlreadyGettingPage=this.getWindowDimensions(),l.setActivateInstance(this),this.windowDimensions=this.getWindowDimensions(),this.settings.target===a?r.DOM.addClass(a.document.body,l.CssClasses.buildingBody):r.DOM.addClass(this.settings.target,l.CssClasses.buildingBody),this.createComponents(),r.Events.fire(this,{type:l.EventTypes.onBeforeShow,target:this}),this.documentOverlay.fadeIn(this.settings.fadeInSpeed,this.onDocumentOverlayFadeIn.bind(this))},getWindowDimensions:function(){return{width:r.DOM.windowWidth(),height:r.DOM.windowHeight()}},createComponents:function(){this.documentOverlay=new e.DocumentOverlayClass(this.settings),this.carousel=new i.CarouselClass(this.cache,this.settings),this.uiLayer=new n.UILayerClass(this.settings),this.settings.captionAndToolbarHide||(this.toolbar=new s.ToolbarClass(this.cache,this.settings))},resetPosition:function(){if(!this._isResettingPosition){var t=this.getWindowDimensions();(r.isNothing(this.windowDimensions)||t.width!==this.windowDimensions.width||t.height!==this.windowDimensions.height)&&(this._isResettingPosition=!0,this.windowDimensions=t,this.destroyZoomPanRotate(),this.documentOverlay.resetPosition(),this.carousel.resetPosition(),r.isNothing(this.toolbar)||this.toolbar.resetPosition(),this.uiLayer.resetPosition(),this._isResettingPosition=!1,r.Events.fire(this,{type:l.EventTypes.onResetPosition,target:this}))}},addEventHandler:function(t,e){r.Events.add(this,t,e)},addEventHandlers:function(){if(r.isNothing(this.windowOrientationChangeHandler)&&(this.windowOrientationChangeHandler=this.onWindowOrientationChange.bind(this),this.windowScrollHandler=this.onWindowScroll.bind(this),this.keyDownHandler=this.onKeyDown.bind(this),this.windowHashChangeHandler=this.onWindowHashChange.bind(this),this.uiLayerTouchHandler=this.onUILayerTouch.bind(this),this.carouselSlideByEndHandler=this.onCarouselSlideByEnd.bind(this),this.carouselSlideshowStartHandler=this.onCarouselSlideshowStart.bind(this),this.carouselSlideshowStopHandler=this.onCarouselSlideshowStop.bind(this),this.toolbarTapHandler=this.onToolbarTap.bind(this),this.toolbarBeforeShowHandler=this.onToolbarBeforeShow.bind(this),this.toolbarShowHandler=this.onToolbarShow.bind(this),this.toolbarBeforeHideHandler=this.onToolbarBeforeHide.bind(this),this.toolbarHideHandler=this.onToolbarHide.bind(this),this.mouseWheelHandler=this.onMouseWheel.bind(this),this.zoomPanRotateTransformHandler=this.onZoomPanRotateTransform.bind(this)),r.Browser.android)this.orientationEventName="resize";else if(r.Browser.iOS&&!r.Browser.safari)r.Events.add(a.document.body,"orientationchange",this.windowOrientationChangeHandler);else{var t=!r.isNothing(a.onorientationchange);this.orientationEventName=t?"orientationchange":"resize"}r.isNothing(this.orientationEventName)||r.Events.add(a,this.orientationEventName,this.windowOrientationChangeHandler),this.settings.target===a&&r.Events.add(a,"scroll",this.windowScrollHandler),this.settings.enableKeyboard&&r.Events.add(a.document,"keydown",this.keyDownHandler),this.isBackEventSupported&&this.settings.backButtonHideEnabled&&(this.windowHashChangeHandler=this.onWindowHashChange.bind(this),this.settings.jQueryMobile?a.location.hash=this.settings.jQueryMobileDialogHash:(this.currentHistoryHashValue="PhotoSwipe"+(new Date).getTime().toString(),a.location.hash=this.currentHistoryHashValue),r.Events.add(a,"hashchange",this.windowHashChangeHandler)),this.settings.enableMouseWheel&&r.Events.add(a,"mousewheel",this.mouseWheelHandler),r.Events.add(this.uiLayer,r.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler),r.Events.add(this.carousel,i.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler),r.Events.add(this.carousel,i.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler),r.Events.add(this.carousel,i.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler),r.isNothing(this.toolbar)||(r.Events.add(this.toolbar,s.EventTypes.onTap,this.toolbarTapHandler),r.Events.add(this.toolbar,s.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler),r.Events.add(this.toolbar,s.EventTypes.onShow,this.toolbarShowHandler),r.Events.add(this.toolbar,s.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler),r.Events.add(this.toolbar,s.EventTypes.onHide,this.toolbarHideHandler))},removeEventHandlers:function(){r.Browser.iOS&&!r.Browser.safari&&r.Events.remove(a.document.body,"orientationchange",this.windowOrientationChangeHandler),r.isNothing(this.orientationEventName)||r.Events.remove(a,this.orientationEventName,this.windowOrientationChangeHandler),r.Events.remove(a,"scroll",this.windowScrollHandler),this.settings.enableKeyboard&&r.Events.remove(a.document,"keydown",this.keyDownHandler),this.isBackEventSupported&&this.settings.backButtonHideEnabled&&r.Events.remove(a,"hashchange",this.windowHashChangeHandler),this.settings.enableMouseWheel&&r.Events.remove(a,"mousewheel",this.mouseWheelHandler),r.isNothing(this.uiLayer)||r.Events.remove(this.uiLayer,r.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler),r.isNothing(this.toolbar)||(r.Events.remove(this.carousel,i.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler),r.Events.remove(this.carousel,i.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler),r.Events.remove(this.carousel,i.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler)),r.isNothing(this.toolbar)||(r.Events.remove(this.toolbar,s.EventTypes.onTap,this.toolbarTapHandler),r.Events.remove(this.toolbar,s.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler),r.Events.remove(this.toolbar,s.EventTypes.onShow,this.toolbarShowHandler),r.Events.remove(this.toolbar,s.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler),r.Events.remove(this.toolbar,s.EventTypes.onHide,this.toolbarHideHandler))},hide:function(){if(!this.settings.preventHide){if(r.isNothing(this.documentOverlay))throw"Code.PhotoSwipe.PhotoSwipeClass.hide: PhotoSwipe instance is already hidden";r.isNothing(this.hiding)&&(this.clearUIWebViewResetPositionTimeout(),this.destroyZoomPanRotate(),this.removeEventHandlers(),r.Events.fire(this,{type:l.EventTypes.onBeforeHide,target:this}),this.uiLayer.dispose(),this.uiLayer=null,r.isNothing(this.toolbar)||(this.toolbar.dispose(),this.toolbar=null),this.carousel.dispose(),this.carousel=null,r.DOM.removeClass(a.document.body,l.CssClasses.activeBody),this.documentOverlay.dispose(),this.documentOverlay=null,this._isResettingPosition=!1,l.unsetActivateInstance(this),r.Events.fire(this,{type:l.EventTypes.onHide,target:this}),this.goBackInHistory())}},goBackInHistory:function(){this.isBackEventSupported&&this.settings.backButtonHideEnabled&&(this.backButtonClicked||a.history.back())},play:function(){this.isZoomActive()||this.settings.preventSlideshow||r.isNothing(this.carousel)||(!r.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.toolbar.fadeOut(),this.carousel.startSlideshow())},stop:function(){this.isZoomActive()||r.isNothing(this.carousel)||this.carousel.stopSlideshow()},previous:function(){this.isZoomActive()||r.isNothing(this.carousel)||this.carousel.previous()},next:function(){this.isZoomActive()||r.isNothing(this.carousel)||this.carousel.next()},toggleToolbar:function(){this.isZoomActive()||r.isNothing(this.toolbar)||this.toolbar.toggleVisibility(this.currentIndex)},fadeOutToolbarIfVisible:function(){!r.isNothing(this.toolbar)&&this.toolbar.isVisible&&0<this.settings.captionAndToolbarAutoHideDelay&&this.toolbar.fadeOut()},createZoomPanRotate:function(){this.stop(),this.canUserZoom()&&!this.isZoomActive()&&(r.Events.fire(this,l.EventTypes.onBeforeZoomPanRotateShow),this.zoomPanRotate=new h.ZoomPanRotateClass(this.settings,this.cache.images[this.currentIndex],this.uiLayer),this.uiLayer.captureSettings.preventDefaultTouchEvents=!0,r.Events.add(this.zoomPanRotate,l.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler),r.Events.fire(this,l.EventTypes.onZoomPanRotateShow),!r.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.toolbar.fadeOut())},destroyZoomPanRotate:function(){r.isNothing(this.zoomPanRotate)||(r.Events.fire(this,l.EventTypes.onBeforeZoomPanRotateHide),r.Events.remove(this.zoomPanRotate,l.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler),this.zoomPanRotate.dispose(),this.zoomPanRotate=null,this.uiLayer.captureSettings.preventDefaultTouchEvents=this.settings.preventDefaultTouchEvents,r.Events.fire(this,l.EventTypes.onZoomPanRotateHide))},canUserZoom:function(){var t,e;if(r.Browser.msie){if(t=document.createElement("div"),r.isNothing(t.style.msTransform))return!1}else if(!r.Browser.isCSSTransformSupported)return!1;return!!this.settings.allowUserZoom&&(!this.carousel.isSliding&&(e=this.cache.images[this.currentIndex],!r.isNothing(e)&&!e.isLoading))},isZoomActive:function(){return!r.isNothing(this.zoomPanRotate)},getCurrentImage:function(){return this.cache.images[this.currentIndex]},onDocumentOverlayFadeIn:function(t){a.setTimeout(function(){var t=this.settings.target===a?a.document.body:this.settings.target;r.DOM.removeClass(t,l.CssClasses.buildingBody),r.DOM.addClass(t,l.CssClasses.activeBody),this.addEventHandlers(),this.carousel.show(this.currentIndex),this.uiLayer.show(),this.settings.autoStartSlideshow?this.play():r.isNothing(this.toolbar)||this.toolbar.show(this.currentIndex),r.Events.fire(this,{type:l.EventTypes.onShow,target:this}),this.setUIWebViewResetPositionTimeout()}.bind(this),250)},setUIWebViewResetPositionTimeout:function(){this.settings.enableUIWebViewRepositionTimeout&&r.Browser.iOS&&!r.Browser.safari&&(r.isNothing(this._uiWebViewResetPositionTimeout)||a.clearTimeout(this._uiWebViewResetPositionTimeout),this._uiWebViewResetPositionTimeout=a.setTimeout(function(){this.resetPosition(),this.setUIWebViewResetPositionTimeout()}.bind(this),this.settings.uiWebViewResetPositionDelay))},clearUIWebViewResetPositionTimeout:function(){r.isNothing(this._uiWebViewResetPositionTimeout)||a.clearTimeout(this._uiWebViewResetPositionTimeout)},onWindowScroll:function(t){this.resetPosition()},onWindowOrientationChange:function(t){this.resetPosition()},onWindowHashChange:function(t){var e="#"+(this.settings.jQueryMobile?this.settings.jQueryMobileDialogHash:this.currentHistoryHashValue);a.location.hash!==e&&(this.backButtonClicked=!0,this.hide())},onKeyDown:function(t){37===t.keyCode?(t.preventDefault(),this.previous()):39===t.keyCode?(t.preventDefault(),this.next()):38===t.keyCode||40===t.keyCode?t.preventDefault():27===t.keyCode?(t.preventDefault(),this.hide()):32===t.keyCode?(this.settings.hideToolbar?this.hide():this.toggleToolbar(),t.preventDefault()):13===t.keyCode&&(t.preventDefault(),this.play())},onUILayerTouch:function(t){if(this.isZoomActive())switch(t.action){case r.TouchElement.ActionTypes.gestureChange:this.zoomPanRotate.zoomRotate(t.scale,this.settings.allowRotationOnUserZoom?t.rotation:0);break;case r.TouchElement.ActionTypes.gestureEnd:this.zoomPanRotate.setStartingScaleAndRotation(t.scale,this.settings.allowRotationOnUserZoom?t.rotation:0);break;case r.TouchElement.ActionTypes.touchStart:this.zoomPanRotate.panStart(t.point);break;case r.TouchElement.ActionTypes.touchMove:this.zoomPanRotate.pan(t.point);break;case r.TouchElement.ActionTypes.doubleTap:this.destroyZoomPanRotate(),this.toggleToolbar();break;case r.TouchElement.ActionTypes.swipeLeft:this.destroyZoomPanRotate(),this.next(),this.toggleToolbar();break;case r.TouchElement.ActionTypes.swipeRight:this.destroyZoomPanRotate(),this.previous(),this.toggleToolbar()}else switch(t.action){case r.TouchElement.ActionTypes.touchMove:case r.TouchElement.ActionTypes.swipeLeft:case r.TouchElement.ActionTypes.swipeRight:this.fadeOutToolbarIfVisible(),this.carousel.onTouch(t.action,t.point);break;case r.TouchElement.ActionTypes.touchStart:case r.TouchElement.ActionTypes.touchMoveEnd:this.carousel.onTouch(t.action,t.point);break;case r.TouchElement.ActionTypes.tap:this.toggleToolbar();break;case r.TouchElement.ActionTypes.doubleTap:this.settings.target===a&&(t.point.x-=r.DOM.windowScrollLeft(),t.point.y-=r.DOM.windowScrollTop());var e=this.cache.images[this.currentIndex].imageEl,i=a.parseInt(r.DOM.getStyle(e,"top"),10),s=a.parseInt(r.DOM.getStyle(e,"left"),10),o=s+r.DOM.width(e),n=i+r.DOM.height(e);t.point.x<s?t.point.x=s:t.point.x>o&&(t.point.x=o),t.point.y<i?t.point.y=i:t.point.y>n&&(t.point.y=n),this.createZoomPanRotate(),this.isZoomActive()&&this.zoomPanRotate.zoomAndPanToPoint(this.settings.doubleTapZoomLevel,t.point);break;case r.TouchElement.ActionTypes.gestureStart:this.createZoomPanRotate()}r.Events.fire(this,{type:l.EventTypes.onTouch,target:this,point:t.point,action:t.action})},onCarouselSlideByEnd:function(t){this.currentIndex=t.cacheIndex,r.isNothing(this.toolbar)||(this.toolbar.setCaption(this.currentIndex),this.toolbar.setToolbarStatus(this.currentIndex)),r.Events.fire(this,{type:l.EventTypes.onDisplayImage,target:this,action:t.action,index:t.cacheIndex})},onToolbarTap:function(t){switch(t.action){case s.ToolbarAction.next:this.next();break;case s.ToolbarAction.previous:this.previous();break;case s.ToolbarAction.close:this.hide();break;case s.ToolbarAction.play:this.play()}r.Events.fire(this,{type:l.EventTypes.onToolbarTap,target:this,toolbarAction:t.action,tapTarget:t.tapTarget})},onMouseWheel:function(t){var e=r.Events.getWheelDelta(t);t.timeStamp-(this.mouseWheelStartTime||0)<this.settings.mouseWheelSpeed||(this.mouseWheelStartTime=t.timeStamp,this.settings.invertMouseWheel&&(e*=-1),e<0?this.next():0<e&&this.previous())},onCarouselSlideshowStart:function(t){r.Events.fire(this,{type:l.EventTypes.onSlideshowStart,target:this})},onCarouselSlideshowStop:function(t){r.Events.fire(this,{type:l.EventTypes.onSlideshowStop,target:this})},onToolbarBeforeShow:function(t){r.Events.fire(this,{type:l.EventTypes.onBeforeCaptionAndToolbarShow,target:this})},onToolbarShow:function(t){r.Events.fire(this,{type:l.EventTypes.onCaptionAndToolbarShow,target:this})},onToolbarBeforeHide:function(t){r.Events.fire(this,{type:l.EventTypes.onBeforeCaptionAndToolbarHide,target:this})},onToolbarHide:function(t){r.Events.fire(this,{type:l.EventTypes.onCaptionAndToolbarHide,target:this})},onZoomPanRotateTransform:function(t){r.Events.fire(this,{target:this,type:l.EventTypes.onZoomPanRotateTransform,scale:t.scale,rotation:t.rotation,rotationDegs:t.rotationDegs,translateX:t.translateX,translateY:t.translateY})}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Cache,window.Code.PhotoSwipe.DocumentOverlay,window.Code.PhotoSwipe.Carousel,window.Code.PhotoSwipe.Toolbar,window.Code.PhotoSwipe.UILayer,window.Code.PhotoSwipe.ZoomPanRotate);